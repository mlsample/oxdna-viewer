(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{25731:(t,e,o)=>{"use strict";o.d(e,{F:()=>n});var a=o(91950);async function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.fr,r=await fetch("".concat(o).concat(t),{...e,headers:{"Content-Type":"application/json",...e.headers}});if(!r.ok){let e=await r.text();throw console.error("API Error (".concat(r.status,") on ").concat(t,": ").concat(e)),Error("API request failed: ".concat(r.status," ").concat(r.statusText," - ").concat(e))}let n=r.headers.get("content-type");return n&&n.includes("application/json")?r.json():r.text()}let n={startJob:t=>{let e=new FormData;Object.keys(t).forEach(o=>{let a=t[o];"simulationType"===o?e.append("MD",String("MD"===a)):a instanceof File?e.append(o,a,a.name):null!=a&&e.append(o,String(a))});let o=localStorage.getItem("token");return o?fetch("".concat(a.fr,"/startJobMultipart"),{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(o)}}).then(async t=>{if(!t.ok){let e=await t.text();throw console.error("API Error (".concat(t.status,") on /startJobMultipart: ").concat(e)),Error("API request failed: ".concat(t.status," ").concat(t.statusText," - ").concat(e))}return t.text()}):Promise.reject(Error("No authentication token found."))},runEnhancedSamplingJob:t=>{let e=new FormData;Object.keys(t).forEach(o=>{let a=t[o];"samplingType"!==o&&("proteinFile"===o&&a instanceof File?e.append("protein",a,a.name):a instanceof File?e.append(o,a,a.name):null!=a&&e.append(o,String(a)))});let o=localStorage.getItem("token");return o?fetch("".concat(a.fr,"/runOxdnaUmbrella"),{method:"POST",body:e,headers:{Authorization:"Bearer ".concat(o)}}).then(async t=>{if(!t.ok){let e=await t.text();throw console.error("API Error (".concat(t.status,") on /runOxdnaUmbrella: ").concat(e)),Error("API request failed: ".concat(t.status," ").concat(t.statusText," - ").concat(e))}return t.text()}):Promise.reject(Error("No authentication token found."))},startAnalysisJob:t=>{let e=localStorage.getItem("token");if(!e)return Promise.reject(Error("No authentication token found."));let o=new FormData;return Object.keys(t).forEach(e=>{let a=t[e];a instanceof File?o.append(e,a,a.name):null!=a&&o.append(e,String(a))}),fetch("".concat(a.fr,"/startAnalysisMultipart"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:o}).then(async t=>{if(!t.ok){let e=await t.text();throw console.error("API Error (".concat(t.status,") on /startAnalysisMultipart: ").concat(e)),Error("API request failed: ".concat(t.status," ").concat(t.statusText," - ").concat(e))}return t.text()})},stopJob:t=>{let e=localStorage.getItem("token");return e?r("/stopJob/".concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}):Promise.reject(Error("No authentication token found."))},resumeJob:t=>{let e=localStorage.getItem("token");return e?r("/resumeJob/".concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}):Promise.reject(Error("No authentication token found."))},deleteJob:t=>{let e=localStorage.getItem("token");return e?r("/deleteJob/".concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}):Promise.reject(Error("No authentication token found."))},getJobStatus:t=>{let e=localStorage.getItem("token");return e?r("/getJobStatus/".concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}):Promise.reject(Error("No authentication token found."))},getJobsByUser:async t=>{let e=localStorage.getItem("token");if(!e)throw Error("No authentication token found.");try{console.log("2");let t=await r("/getJobs",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!t||"object"!=typeof t)return console.warn("getJobsByUser received non-object response:",t),[];return Object.values(t)}catch(e){if(console.error("Failed to get jobs for user ".concat(t,":"),e),e instanceof Error&&e.message.includes("404"))return[];throw e}},getEnergyData:async t=>r("/energy/".concat(t,"/0/3"),{method:"GET"}),getServerResources:async()=>Object.entries(await r("/getResources",{method:"GET"})).map((t,e)=>{let[o,a]=t;return{id:o,name:"Server ".concat(e+1),CPUavail:a.CPUavail,GPUavail:a.GPUavail,TotalRam:a.totalRAM,RAMavail:a.RAMavail,totalCPU:a.totalCPU}}),downloadFile:async(t,e)=>{let o=localStorage.getItem("token");if(!o)throw Error("No authentication token found.");let r=await fetch("".concat(a.fr,"/download/").concat(t,"/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(o)}});if(!r.ok){let o=await r.text();throw console.error("Download Error (".concat(r.status,") for ").concat(t,"/").concat(e,": ").concat(o)),Error("Download failed: ".concat(r.status," ").concat(r.statusText," - ").concat(o))}return r.blob()},downloadAllFiles:async t=>{let e=localStorage.getItem("token");if(!e)throw Error("No authentication token found.");let o=await fetch("".concat(a.fr,"/downloadAll/").concat(t),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!o.ok){let e=await o.text();throw console.error("Download All Error (".concat(o.status,") for ").concat(t,": ").concat(e)),Error("Download all failed: ".concat(o.status," ").concat(o.statusText," - ").concat(e))}return o.blob()},listJobFiles:async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=localStorage.getItem("token");if(!o)throw Error("No authentication token found.");let a=e?"/list/".concat(t,",").concat(e):"/list/".concat(t),n=await r(a,{method:"GET",headers:{Authorization:"Bearer ".concat(o)}}),c=[],s=[];return Object.keys(n).forEach(t=>{if("Folder"===t&&n.Folder)Object.values(n.Folder).forEach(t=>{"string"==typeof t&&c.push(t)});else{let e=n[t];"string"==typeof e&&s.push(e)}}),{files:s.sort(),folders:c.sort()}},getJobFileContent:async(t,e)=>(await n.downloadFile(t,e)).text(),registerUser:async t=>r("/auth/signup",{method:"POST",body:JSON.stringify({firstName:t.firstName,lastName:t.lastName,email:t.email,institutionName:t.instituteName,password:t.passwordLogin})},a.k1),loginUser:async(t,e)=>r("/auth/login",{method:"POST",body:JSON.stringify({email:t,password:e})},a.k1),getUserProfile:async()=>{let t=localStorage.getItem("token");if(!t)throw Error("No authentication token found.");return console.log(t),r("/auth/profile",{method:"POST",headers:{Authorization:"Bearer ".concat(t)}},a.k1)}}},33792:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>l});var a=o(95155),r=o(12115),n=o(35695),c=o(40283),s=o(68856);function l(){let{isAuthenticated:t,loading:e}=(0,c.A)(),o=(0,n.useRouter)();return((0,r.useEffect)(()=>{e||(t?o.replace("/job-status"):o.replace("/login"))},[t,e,o]),e)?(0,a.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen p-4 bg-background",children:(0,a.jsxs)("div",{className:"space-y-4 w-full max-w-md",children:[(0,a.jsx)(s.E,{className:"h-10 w-full"}),(0,a.jsx)(s.E,{className:"h-10 w-full"}),(0,a.jsx)(s.E,{className:"h-12 w-1/2 mx-auto"})]})}):null}},40283:(t,e,o)=>{"use strict";o.d(e,{A:()=>u,AuthProvider:()=>i});var a=o(95155),r=o(12115),n=o(35695),c=o(25731),s=o(58801);let l=(0,r.createContext)(void 0),i=t=>{let{children:e}=t,[o,i]=(0,r.useState)(null),[u,d]=(0,r.useState)(!0),h=(0,n.useRouter)();(0,r.useEffect)(()=>{(async()=>{let t=localStorage.getItem("token");if(t)try{let e=(0,s.decode)(t);if(1e3*e.exp>Date.now()){let t=await c.F.getUserProfile();i(t)}else localStorage.removeItem("token"),i(null)}catch(t){console.error("Token verification failed:",t),localStorage.removeItem("token"),i(null)}d(!1)})()},[]);let f=async t=>{try{return await c.F.registerUser(t),await m(t.email,t.passwordLogin)}catch(t){return console.error("Registration failed:",t),!1}},m=async(t,e)=>{d(!0);try{let o=await c.F.loginUser(t,e);if(o.token){localStorage.setItem("token",o.token);let t=await c.F.getUserProfile();return i(t),h.push("/job-status"),d(!1),!0}throw Error("Login failed: No token received")}catch(t){return console.error("Login failed:",t),localStorage.removeItem("token"),i(null),d(!1),!1}};return(0,a.jsx)(l.Provider,{value:{user:o,isAuthenticated:!!o,register:f,login:m,logout:()=>{i(null),localStorage.removeItem("token"),h.push("/login")},loading:u},children:e})},u=()=>{let t=(0,r.useContext)(l);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},44043:(t,e,o)=>{Promise.resolve().then(o.bind(o,33792))},68856:(t,e,o)=>{"use strict";o.d(e,{E:()=>n});var a=o(95155),r=o(59434);function n(t){let{className:e,...o}=t;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",e),...o})}}},t=>{var e=e=>t(t.s=e);t.O(0,[268,277,273,509,441,303,358],()=>e(44043)),_N_E=t.O()}]);