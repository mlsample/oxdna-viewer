"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[854],{73854:(e,t,a)=>{a.d(t,{default:()=>I});var s=a(69298),l=a(83130),i=a(74450),n=a(65671),o=a(72003),r=a(99190),d=a(46583),c=a(43177),u=a(87441),m=a(44359),p=a(82535),x=a(51283),f=a(26164);let h=x.bL;x.l9;let j=x.ZL,y=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(x.hJ,{className:(0,f.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:t})});y.displayName=x.hJ.displayName;let b=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(j,{children:[(0,s.jsx)(y,{}),(0,s.jsx)(x.UC,{ref:t,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});b.displayName=x.UC.displayName;let g=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};g.displayName="AlertDialogHeader";let v=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};v.displayName="AlertDialogFooter";let N=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(x.hE,{ref:t,className:(0,f.cn)("text-lg font-semibold",a),...l})});N.displayName=x.hE.displayName;let w=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(x.VY,{ref:t,className:(0,f.cn)("text-sm text-muted-foreground",a),...l})});w.displayName=x.VY.displayName;let F=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(x.rc,{ref:t,className:(0,f.cn)((0,d.r)(),a),...l})});F.displayName=x.rc.displayName;let C=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(x.ZD,{ref:t,className:(0,f.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});C.displayName=x.ZD.displayName;var S=a(36909),R=a(40025),k=a(87849),z=a(96308),A=a(92839),J=a(76261),T=a(79717),V=a(71612);let M=e=>o.Ik({analysisType:o.au.number({required_error:"Please select an analysis type."}),topology:o.bz().optional(),configuration:o.bz().optional(),otherFile1:o.bz().optional(),otherFile2:o.bz().optional(),bool1:o.zM().optional(),int1:o.au.number().optional(),str1:o.Yj().optional(),str2:o.Yj().optional(),double1:o.au.number().optional(),inlist:o.Yj().optional(),cpus:o.au.number().int().positive().optional()}).superRefine((t,a)=>{if(void 0===t.analysisType)return;let s=z.W9.find(e=>e.value===t.analysisType);if(s)for(let l of s.files)!l.required||!e&&("topology"===l.name||"configuration"===l.name)||t[l.name]instanceof File||a.addIssue({code:r.eq.custom,path:[l.name],message:"".concat(l.label," is required.")})});function I(e){let{jobId:t}=e,{user:a}=(0,R.A)(),{toast:o}=(0,A.dj)(),r=!t,[x,f]=(0,l.useState)(!1),[j,y]=(0,l.useState)(!1),I=(0,l.useMemo)(()=>M(r),[r]),q=(0,n.mN)({resolver:(0,i.u)(I),defaultValues:{cpus:1,bool1:!1}}),D=q.watch("analysisType"),Y=(0,l.useMemo)(()=>z.W9.find(e=>e.value===D),[D]),E=(e,t)=>{var a;let s=null==(a=e.target.files)?void 0:a[0];q.setValue(t,s||null,{shouldValidate:!0})},Z=async e=>{if(!a||!Y)return;let s={userID:a.id,analysisType:e.analysisType,cpus:e.cpus||1,bool1:e.bool1,int1:e.int1,str1:e.str1,str2:e.str2,double1:e.double1,inlist:e.inlist,topology:e.topology instanceof File?e.topology:void 0,configuration:e.configuration instanceof File?e.configuration:void 0,otherFile1:e.otherFile1 instanceof File?e.otherFile1:void 0,otherFile2:e.otherFile2 instanceof File?e.otherFile2:void 0};r||(s.jobUuid=t,s.jobLocation=t);try{let e=await k.F.startAnalysisJob(s);o({title:"Analysis Job Submitted",description:"".concat(Y.label," analysis started with ID: ").concat(e,".")}),q.reset({...q.getValues(),str1:"",str2:"",int1:void 0,double1:void 0,bool1:!1})}catch(e){console.error("Failed to submit analysis job:",e),o({title:"Submission Failed",description:e.message||"An unknown error occurred.",variant:"destructive"})}},_=async e=>{if(r||!t||!(null==Y?void 0:Y.outputFile))return void await Z(e);y(!0);try{(await k.F.listJobFiles(t)).includes(Y.outputFile)?f(!0):await Z(e)}catch(t){o({title:"Could not check for existing files.",description:"Proceeding with submission...",variant:"default"}),await Z(e)}finally{y(!1)}};return(0,s.jsxs)(c.lV,{...q,children:[(0,s.jsx)(h,{open:x,onOpenChange:f,children:(0,s.jsxs)(b,{children:[(0,s.jsxs)(g,{children:[(0,s.jsx)(N,{children:"File Already Exists"}),(0,s.jsxs)(w,{children:["The output file ",(0,s.jsx)("code",{className:"bg-muted px-1 py-0.5 rounded font-semibold",children:null==Y?void 0:Y.outputFile})," already exists for this job. Running this analysis again may overwrite it. Are you sure you want to continue?"]})]}),(0,s.jsxs)(v,{children:[(0,s.jsx)(C,{children:"Cancel"}),(0,s.jsx)(F,{onClick:()=>Z(q.getValues()),children:"Yes, Submit Anyway"})]})]})}),(0,s.jsxs)("form",{onSubmit:q.handleSubmit(_),className:"space-y-6",children:[(0,s.jsx)(c.zB,{control:q.control,name:"analysisType",render:e=>{var t;let{field:a}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"Analysis Type"}),(0,s.jsxs)(p.l6,{onValueChange:e=>a.onChange(Number(e)),defaultValue:null==(t=a.value)?void 0:t.toString(),children:[(0,s.jsx)(c.MJ,{children:(0,s.jsx)(p.bq,{children:(0,s.jsx)(p.yv,{placeholder:"Select an analysis protocol..."})})}),(0,s.jsx)(p.gC,{children:z.W9.map(e=>(0,s.jsxs)(p.eb,{value:String(e.value),children:[e.label," (",e.command,")"]},e.value))})]}),Y&&(0,s.jsx)(c.Rr,{children:Y.description}),(0,s.jsx)(c.C5,{})]})}}),Y&&(0,s.jsxs)(T.Zp,{className:"border-dashed",children:[(0,s.jsx)(T.aR,{children:(0,s.jsxs)(T.ZB,{children:["Parameters for: ",Y.label]})}),(0,s.jsxs)(T.Wu,{className:"space-y-4",children:[Y.files.map(e=>{let t=!r&&("topology"===e.name||"configuration"===e.name);return(0,s.jsx)(c.zB,{control:q.control,name:e.name,render:a=>{let{field:l}=a;return(0,s.jsxs)(c.eI,{children:[(0,s.jsxs)(c.lR,{children:[e.label," ",e.required&&!t&&(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),t?(0,s.jsx)("div",{className:"text-sm p-3 bg-muted rounded-md border text-muted-foreground",children:"âœ“ Using file from the original simulation job."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.MJ,{children:(0,s.jsx)(u.p,{type:"file",onChange:t=>E(t,e.name)})}),(0,s.jsx)(c.Rr,{children:e.description}),(0,s.jsx)(c.C5,{})]})]})}},e.name)}),Y.params.map(e=>(0,s.jsx)(c.zB,{control:q.control,name:e.backendName,render:t=>{var a,l;let{field:i}=t;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:e.label}),"boolean"===e.type?(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(c.MJ,{children:(0,s.jsx)(m.d,{checked:i.value,onCheckedChange:i.onChange})}),e.description&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:e.description})]}):"textarea"===e.type?(0,s.jsx)(c.MJ,{children:(0,s.jsx)(S.T,{placeholder:e.description,...i,value:null!=(a=i.value)?a:""})}):(0,s.jsx)(c.MJ,{children:(0,s.jsx)(u.p,{type:e.type,placeholder:e.description,...i,value:null!=(l=i.value)?l:""})}),(0,s.jsx)(c.C5,{})]})}},e.name))]})]}),(0,s.jsx)(V.Separator,{}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(d.$,{type:"submit",size:"lg",disabled:!Y||q.formState.isSubmitting||j,children:[(0,s.jsx)(J.A,{className:"mr-2 h-5 w-5"}),q.formState.isSubmitting||j?"Submitting...":"Submit Analysis"]})})]})]})}}}]);